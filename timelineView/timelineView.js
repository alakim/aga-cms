(function($,H){	function parseDate(str){		var arr = str.split(".");		//return new Date(Date.parse([arr[2], arr[1], arr[0]].join("/")));		return Date.parse(arr.reverse().join("/"));	}		function getTimeRange(doc){		var min, max;		$.each(doc, function(i, itm){			itm.begin = parseDate(itm.begin);			itm.end = parseDate(itm.end);			if(!min) min = itm.begin;			if(!max) max = itm.end;			//console.log(itm);			if(itm.begin<min) min = itm.begin; if(itm.begin>max) max = itm.begin;			if(itm.end<min) min = itm.end; if(itm.end>max) max = itm.end;		});				return {min:min, max:max};	}		var templates = {		main: function(doc, range, pnlSz){with(H){			var xRate = (range.max - range.min)/pnlSz;			console.log(xRate);			return div({"class":"timelineView"},				apply(doc, function(itm){					return div({						"class":"timeline",						style: style({							"margin-left": (itm.begin - range.min)/xRate,							width:(itm.end-itm.begin)/xRate						})					}, itm.name);				})			);		}}	};	function buildView(pnl, doc){		var pnlSz = pnl.width();		var range = getTimeRange(doc);		pnl.html(templates.main(doc, range, pnlSz));	}	$.fn.timelineView = function(tlDoc){		var doc = $.parseJSON(tlDoc);		$(this).each(function(i, el){			buildView($(el), doc);		});	}})(jQuery, Html);